{"version":3,"sources":["api/senderId/senderId.controller.js"],"names":["create","deleteSenderId","index","show","approve","block","createXls","ADMIN","handleError","res","argStatusCode","err","error","statusCode","status","send","notifyAdminSenderIdApproval","senderId","User","find","where","admin","then","user","reject","message","text","name","company","PLAY_URL","id","userId","req","SenderId","findAll","attributes","body","createdBy","senderIds","userSenderId","filter","x","json","length","updatedBy","blockedSenderId","approvedSenderId","catch","destroy","params","data","next","roleId","query","fl","promise","resolve","loginUrl","origin","users","senderIdStatusId","$not","map","$and","split","include","model","as","limit","offset","options","Number","reduce","nxt","key","value","all","Selling","count","routes","numFound","items","meta","update","end","wb","Workbook","ws","addWorksheet","cell","string","forEach","item","i","write"],"mappings":"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","file":"senderId.controller.js","sourcesContent":["import xl from 'excel4node';\nimport logger from '../../components/logger';\nimport config from '../../config/environment';\nimport { ROLES } from '../../config/constants';\nimport { notifyOnUserChannel } from '../../components/notify';\nimport db from '../../conn/sqldb';\n\nconst { ADMIN } = ROLES;\n\nfunction handleError(res, argStatusCode, err) {\n  logger.error('user.controller', err);\n  const statusCode = argStatusCode || 500;\n  res.status(statusCode).send(err);\n}\n\nfunction notifyAdminSenderIdApproval(senderId) {\n  return db.User.find({ where: { admin: 2 } })\n    .then((user) => {\n      if (!user) return Promise.reject({ message: 'No admin user found' });\n      const text = `Request to approve ${senderId.name} - ${senderId.company}. ${\n        config.PLAY_URL}/senderId/${senderId.id}`;\n      return notifyOnUserChannel({ userId: user.id, text });\n    });\n}\n\nexport function create(req, res) {\n  return db.SenderId\n    .findAll({\n      attributes: ['id', 'status', 'createdBy'],\n      where: { name: req.body.name, createdBy: req.user.id },\n    }).then((senderIds) => {\n      const userSenderId = senderIds.filter(x => (x.createdBy === req.user.id))[0];\n      if (userSenderId) {\n        if (userSenderId.status === 1) {\n          return res.json({ message: 'Approval Pending.' });\n        }\n        if (userSenderId.status === 2) {\n          return res.status(500).json({ message: 'Blocked.' });\n        }\n        return res.status(500).json({ message: 'Duplicate' });\n      }\n      if (!senderIds.length) {\n        return db.SenderId.create(Object\n          .assign({}, req.body, { createdBy: req.user.id, updatedBy: req.user.id }))\n          .then((senderId) => {\n            notifyAdminSenderIdApproval(senderId);\n            return res.json({ message: 'success' });\n          });\n      }\n      const blockedSenderId = senderIds.filter(x => (x.status === 3))[0];\n      const approvedSenderId = senderIds.filter(x => (x.status === 2))[0];\n      if (!blockedSenderId && approvedSenderId) {\n        return db.SenderId.create(Object.assign(\n          { status: approvedSenderId.status },\n          req.body,\n          { createdBy: req.user.id, updatedBy: req.user.id }))\n          .then((senderId) => {\n            notifyAdminSenderIdApproval(senderId);\n            return res.json({ message: 'success' });\n          });\n      }\n      return db.SenderId.create(Object.assign(\n        {},\n        req.body,\n        { createdBy: req.user.id, updatedBy: req.user.id }))\n        .then((senderId) => {\n          notifyAdminSenderIdApproval(senderId);\n          return res.json({ message: 'success' });\n        });\n    })\n    .catch(err => handleError(res, 500, err));\n}\n\nexport function deleteSenderId(req, res) {\n  return db.SenderId.destroy({ where: { id: req.params.id } })\n    .then(data => res.json(data))\n    .catch(err => handleError(res, 500, err));\n}\n\nexport function index(req, res, next) {\n  if (req.user.roleId !== ADMIN) {\n    const { status, fl } = req.query;\n    let promise;\n    if (req.user.admin === 2) {\n      promise = Promise.resolve();\n    } else if (req.user.admin) {\n      promise = db.User.findAll({ attributes: ['id'], where: { loginUrl: req.origin } });\n    } else {\n      promise = Promise.resolve([req.user]);\n    }\n    return promise\n      .then((users) => {\n        const where = { senderIdStatusId: { $not: 3 } };\n        if (users) where.createdBy = users.map(x => x.id);\n        if (status) where.$and = { senderIdStatusId: status.split(',') };\n        return db.SenderId.findAll({\n          attributes: fl ? fl.split(',') : ['id', 'name'],\n          where,\n          include: [{\n            model: db.User,\n            as: 'CreatedBy',\n            attributes: ['id', 'name', 'admin'],\n          }] })\n          .then(data => res.json(data));\n      })\n      .catch(err => handleError(res, 500, err));\n  }\n\n\n  const { limit = 20, offset = 0, fl, where } = req.query;\n\n  const options = {\n    attributes: fl ? fl.split(',') : ['id', 'routeId', 'limit', 'userId'],\n    limit: Number(limit),\n    offset: Number(offset),\n  };\n\n  if (where) {\n    options.where = where.split(',').reduce((nxt, x) => {\n      const [key, value] = x.split(':');\n      return Object.assign(nxt, { [key]: value });\n    }, {});\n  }\n\n  return Promise\n    .all([\n      db.Selling\n        .findAll(options),\n      db.Selling\n        .count(),\n    ])\n    .then(([routes, numFound]) => res.json({ items: routes, meta: { numFound } }))\n    .catch(next);\n}\n\nexport function show(req, res) {\n  let promise;\n  if (req.user.admin === 2) {\n    promise = Promise.resolve();\n  } else if (req.user.admin) {\n    promise = db.User.findAll({ attributes: ['id'], where: { loginUrl: req.origin } });\n  } else {\n    promise = Promise.resolve([req.user]);\n  }\n  return promise\n    .then((users) => {\n      const where = { id: req.params.id };\n      if (users) where.createdBy = users.map(x => x.id);\n      return db.SenderId.find({\n        where,\n        include: [{\n          model: db.User,\n          as: 'CreatedBy',\n          attributes: ['id', 'name', 'admin'],\n        }] })\n        .then(data => res.json(data));\n    })\n    .catch(err => handleError(res, 500, err));\n}\n\nexport function approve(req, res) {\n  return db.SenderId.update({ status: true }, { where: { id: req.params.id } })\n    .then(() => res.status(202).end())\n    .catch(err => handleError(res, 500, err));\n}\n\nexport function block(req, res) {\n  return db.SenderId.update({ status: false }, { where: { id: req.params.id } })\n    .then(() => res.status(202).end())\n    .catch(err => handleError(res, 500, err));\n}\n\nexport function createXls(req, res, next) {\n  return db.SenderId\n    .findAll({})\n    .then((data) => {\n      const senderId = data.map(x => x.name);\n      const wb = new xl.Workbook();\n      const ws = wb.addWorksheet('Sheet 1');\n      ws.cell(1, 1).string('Sender Ids');\n      senderId.forEach((item, i) => {\n        ws.cell(i + 2, 1).string(item);\n      });\n      wb.write('Excel.xlsx', res);\n    })\n    .catch(next);\n}\n"]}