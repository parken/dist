{"version":3,"sources":["api/upstream/upstream.controller.js"],"names":["createPlan","handleError","res","argStatusCode","err","error","statusCode","status","send","req","count","body","user","roleId","json","message","UpstreamPlan","create","upstreamId","params","id","createdBy","updatedBy","then","end","catch"],"mappings":";;;;;QASgBA,U,GAAAA,U;;AAThB;;;;AACA;;;;;;AAEA,SAASC,WAAT,CAAqBC,GAArB,EAA0BC,aAA1B,EAAyCC,GAAzC,EAA8C;AAC5C,kBAAOC,KAAP,CAAa,iBAAb,EAAgCD,GAAhC;AACA,MAAME,aAAaH,iBAAiB,GAApC;AACAD,MAAIK,MAAJ,CAAWD,UAAX,EAAuBE,IAAvB,CAA4BJ,GAA5B;AACD;;AAEM,SAASJ,UAAT,CAAoBS,GAApB,EAAyBP,GAAzB,EAA8B;AAAA,MAC3BQ,KAD2B,GACjBD,IAAIE,IADa,CAC3BD,KAD2B;;AAEnC,MAAI,CAACA,KAAD,IAAUD,IAAIG,IAAJ,CAASC,MAAT,KAAoB,CAAlC,EAAqC,OAAOX,IAAIK,MAAJ,CAAW,GAAX,EAAgBO,IAAhB,CAAqB,EAAEC,SAAS,iBAAX,EAArB,CAAP;AACrC,SAAO,gBAAGC,YAAH,CAAgBC,MAAhB,CAAuB;AAC5BC,gBAAYT,IAAIU,MAAJ,CAAWC,EADK;AAE5BC,eAAWZ,IAAIG,IAAJ,CAASQ,EAFQ;AAG5BE,eAAWb,IAAIG,IAAJ,CAASQ,EAHQ;AAI5BV;AAJ4B,GAAvB,EAKJa,IALI,CAKC;AAAA,WAAMrB,IAAIK,MAAJ,CAAW,GAAX,EAAgBiB,GAAhB,EAAN;AAAA,GALD,EAMJC,KANI,CAME;AAAA,WAAOxB,YAAYC,GAAZ,EAAiB,GAAjB,EAAsBE,GAAtB,CAAP;AAAA,GANF,CAAP;AAOD","file":"upstream.controller.js","sourcesContent":["import logger from '../../components/logger/index';\nimport db from '../../conn/sqldb/index';\n\nfunction handleError(res, argStatusCode, err) {\n  logger.error('user.controller', err);\n  const statusCode = argStatusCode || 500;\n  res.status(statusCode).send(err);\n}\n\nexport function createPlan(req, res) {\n  const { count } = req.body;\n  if (!count || req.user.roleId !== 1) return res.status(404).json({ message: 'Invalid Request' });\n  return db.UpstreamPlan.create({\n    upstreamId: req.params.id,\n    createdBy: req.user.id,\n    updatedBy: req.user.id,\n    count,\n  }).then(() => res.status(202).end())\n    .catch(err => handleError(res, 500, err));\n}\n"]}