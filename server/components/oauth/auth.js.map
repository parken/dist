{"version":3,"sources":["components/oauth/auth.js"],"names":["authorise","logout","req","res","next","RefreshToken","find","attributes","where","refreshToken","body","token","raw","then","s","sessionId","Session","resolve","json","catch"],"mappings":";;;;;;;;;;kBAGe,YAAY;AACzB,SAAO,gBAAMA,SAAN,EAAP;AACD,C;;QAEeC,M,GAAAA,M;;AAPhB;;;;AACA;;;;;;AAMO,SAASA,MAAT,CAAgBC,GAAhB,EAAqBC,GAArB,EAA0BC,IAA1B,EAAgC;AACrC,kBAAGC,YAAH,CACGC,IADH,CACQ;AACJC,gBAAY,CAAC,WAAD,CADR;AAEJC,WAAO;AACLC,oBAAcP,IAAIQ,IAAJ,CAASC;AADlB,KAFH;AAKJC,SAAK;AALD,GADR,EAQGC,IARH,CAQQ,UAACC,CAAD;AAAA,WAAQA,KAAKA,EAAEC,SAAP,GAAmB,gBAAGC,OAAH,CAAWf,MAAX,kBAAsBa,EAAEC,SAAxB,CAAnB,GAAwD,kBAAQE,OAAR,EAAhE;AAAA,GARR,EASGJ,IATH,CASQ;AAAA,WAAKV,IAAIe,IAAJ,CAASJ,CAAT,CAAL;AAAA,GATR,EAUGK,KAVH,CAUSf,IAVT;AAWD","file":"auth.js","sourcesContent":["import db from '../../conn/sqldb';\nimport oauth from './index';\n\nexport default function () {\n  return oauth.authorise();\n}\n\nexport function logout(req, res, next) {\n  db.RefreshToken\n    .find({\n      attributes: ['sessionId'],\n      where: {\n        refreshToken: req.body.token,\n      },\n      raw: true,\n    })\n    .then((s) => (s && s.sessionId ? db.Session.logout(db, s.sessionId) : Promise.resolve()))\n    .then(s => res.json(s))\n    .catch(next);\n}\n"]}